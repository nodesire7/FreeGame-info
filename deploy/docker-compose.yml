services:
  generator:
    image: "nodesire77/game_info:${IMAGE_TAG}"
    container_name: game_info_generator
    volumes:
      - ./data:/data
    # one-shot 生成（不会常驻），建议配合定时任务或手动执行
    command: ["python", "main.py", "/data/site", "--history-dir", "/data/history"]

  web:
    image: nginx:alpine
    container_name: game_info_web
    depends_on:
      - generator
    ports:
      - "${PORT:-8080}:80"
    volumes:
      - ./data/site:/usr/share/nginx/html:ro
    restart: unless-stopped


